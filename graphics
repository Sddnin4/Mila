-- ROBLOX ADVANCED GRAPHICS ENHANCEMENT SCRIPT V4.0
-- UI ƒë·∫πp v·ªõi 2 tab: TƒÉng ƒê·ªì H·ªça & Gi·∫£m ƒê·ªì H·ªça

local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local SoundService = game:GetService("SoundService")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local camera = Workspace.CurrentCamera

-- Settings l∆∞u tr·ªØ
local settings = {
    autoEnhance = true,
    fpsBoost = true,
    qualityLevel = "High",
    particleOptimize = true,
    soundOptimize = true,
    uiVisible = true,
    currentTab = "enhance" -- "enhance" or "performance"
}

-- Background processes
local fpsMonitor = nil
local backgroundProcesses = {}

-- T·∫°o GUI ch√≠nh v·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "GraphicsBoosterV4_" .. math.random(1000, 9999)
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

-- Main Container
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 450, 0, 320)
mainFrame.Position = UDim2.new(0.5, -225, 0.5, -160)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

-- Glass morphism effect
local blur = Instance.new("UICorner")
blur.CornerRadius = UDim.new(0, 20)
blur.Parent = mainFrame

local frameGradient = Instance.new("UIGradient")
frameGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 30, 45)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(25, 25, 40)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 15, 25))
})
frameGradient.Rotation = 135
frameGradient.Parent = mainFrame

-- Glowing border effect
local glowFrame = Instance.new("Frame")
glowFrame.Size = UDim2.new(1, 4, 1, 4)
glowFrame.Position = UDim2.new(0, -2, 0, -2)
glowFrame.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
glowFrame.BackgroundTransparency = 0.7
glowFrame.BorderSizePixel = 0
glowFrame.ZIndex = -1
glowFrame.Parent = mainFrame

local glowCorner = Instance.new("UICorner")
glowCorner.CornerRadius = UDim.new(0, 22)
glowCorner.Parent = glowFrame

-- Animated glow effect
local glowTween = TweenService:Create(glowFrame,
    TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true),
    {BackgroundTransparency = 0.3}
)
glowTween:Play()

-- Header Section
local headerFrame = Instance.new("Frame")
headerFrame.Size = UDim2.new(1, 0, 0, 60)
headerFrame.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
headerFrame.BorderSizePixel = 0
headerFrame.Parent = mainFrame

local headerGradient = Instance.new("UIGradient")
headerGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(100, 160, 220)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(70, 130, 180))
})
headerGradient.Rotation = 45
headerGradient.Parent = headerFrame

local headerCorner = Instance.new("UICorner")
headerCorner.CornerRadius = UDim.new(0, 20)
headerCorner.Parent = headerFrame

-- Title v·ªõi animation
local title = Instance.new("TextLabel")
title.Size = UDim2.new(0.7, 0, 1, 0)
title.Position = UDim2.new(0, 15, 0, 0)
title.BackgroundTransparency = 1
title.Text = "üéÆ GRAPHICS MASTER V4"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextScaled = true
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = headerFrame

-- Close button v·ªõi hi·ªáu ·ª©ng ƒë·∫πp
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 40, 0, 40)
closeButton.Position = UDim2.new(1, -50, 0, 10)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
closeButton.BorderSizePixel = 0
closeButton.Text = "‚úï"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextScaled = true
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = headerFrame

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 20)
closeCorner.Parent = closeButton

-- Close button hover effect
closeButton.MouseEnter:Connect(function()
    local hoverTween = TweenService:Create(closeButton,
        TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {BackgroundColor3 = Color3.fromRGB(255, 100, 100), Size = UDim2.new(0, 42, 0, 42)}
    )
    hoverTween:Play()
end)

closeButton.MouseLeave:Connect(function()
    local leaveTween = TweenService:Create(closeButton,
        TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {BackgroundColor3 = Color3.fromRGB(255, 70, 70), Size = UDim2.new(0, 40, 0, 40)}
    )
    leaveTween:Play()
end)

-- Tab System
local tabFrame = Instance.new("Frame")
tabFrame.Size = UDim2.new(1, -20, 0, 50)
tabFrame.Position = UDim2.new(0, 10, 0, 70)
tabFrame.BackgroundTransparency = 1
tabFrame.Parent = mainFrame

-- Tab buttons
local enhanceTab = Instance.new("TextButton")
enhanceTab.Size = UDim2.new(0.48, 0, 1, 0)
enhanceTab.Position = UDim2.new(0, 0, 0, 0)
enhanceTab.BackgroundColor3 = Color3.fromRGB(50, 200, 100)
enhanceTab.BorderSizePixel = 0
enhanceTab.Text = "‚ú® TƒÇNG ƒê·ªí H·ªåA"
enhanceTab.TextColor3 = Color3.fromRGB(255, 255, 255)
enhanceTab.TextScaled = true
enhanceTab.Font = Enum.Font.GothamBold
enhanceTab.Parent = tabFrame

local enhanceCorner = Instance.new("UICorner")
enhanceCorner.CornerRadius = UDim.new(0, 15)
enhanceCorner.Parent = enhanceTab

local performanceTab = Instance.new("TextButton")
performanceTab.Size = UDim2.new(0.48, 0, 1, 0)
performanceTab.Position = UDim2.new(0.52, 0, 0, 0)
performanceTab.BackgroundColor3 = Color3.fromRGB(100, 100, 120)
performanceTab.BorderSizePixel = 0
performanceTab.Text = "üöÄ GI·∫¢M ƒê·ªí H·ªåA"
performanceTab.TextColor3 = Color3.fromRGB(200, 200, 200)
performanceTab.TextScaled = true
performanceTab.Font = Enum.Font.GothamBold
performanceTab.Parent = tabFrame

local performanceCorner = Instance.new("UICorner")
performanceCorner.CornerRadius = UDim.new(0, 15)
performanceCorner.Parent = performanceTab

-- Content Frame cho tabs
local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, -20, 0, 180)
contentFrame.Position = UDim2.new(0, 10, 0, 130)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- Enhance Tab Content
local enhanceContent = Instance.new("ScrollingFrame")
enhanceContent.Size = UDim2.new(1, 0, 1, 0)
enhanceContent.BackgroundTransparency = 1
enhanceContent.BorderSizePixel = 0
enhanceContent.ScrollBarThickness = 6
enhanceContent.ScrollBarImageColor3 = Color3.fromRGB(70, 130, 180)
enhanceContent.Visible = true
enhanceContent.Parent = contentFrame

local enhanceLayout = Instance.new("UIGridLayout")
enhanceLayout.CellSize = UDim2.new(0, 130, 0, 40)
enhanceLayout.CellPadding = UDim2.new(0, 8, 0, 8)
enhanceLayout.SortOrder = Enum.SortOrder.LayoutOrder
enhanceLayout.Parent = enhanceContent

-- Performance Tab Content  
local performanceContent = Instance.new("ScrollingFrame")
performanceContent.Size = UDim2.new(1, 0, 1, 0)
performanceContent.BackgroundTransparency = 1
performanceContent.BorderSizePixel = 0
performanceContent.ScrollBarThickness = 6
performanceContent.ScrollBarImageColor3 = Color3.fromRGB(70, 130, 180)
performanceContent.Visible = false
performanceContent.Parent = contentFrame

local performanceLayout = Instance.new("UIGridLayout")
performanceLayout.CellSize = UDim2.new(0, 130, 0, 40)
performanceLayout.CellPadding = UDim2.new(0, 8, 0, 8)
performanceLayout.SortOrder = Enum.SortOrder.LayoutOrder
performanceLayout.Parent = performanceContent

-- Status Bar
local statusFrame = Instance.new("Frame")
statusFrame.Size = UDim2.new(1, -20, 0, 25)
statusFrame.Position = UDim2.new(0, 10, 1, -35)
statusFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
statusFrame.BorderSizePixel = 0
statusFrame.Parent = mainFrame

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(0, 12)
statusCorner.Parent = statusFrame

local fpsLabel = Instance.new("TextLabel")
fpsLabel.Size = UDim2.new(0.5, 0, 1, 0)
fpsLabel.BackgroundTransparency = 1
fpsLabel.Text = "üìä FPS: --"
fpsLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
fpsLabel.TextScaled = true
fpsLabel.Font = Enum.Font.GothamSemibold
fpsLabel.TextXAlignment = Enum.TextXAlignment.Left
fpsLabel.Parent = statusFrame

local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(0.5, 0, 1, 0)
statusLabel.Position = UDim2.new(0.5, 0, 0, 0)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "‚ö° Ready"
statusLabel.TextColor3 = Color3.fromRGB(0, 255, 127)
statusLabel.TextScaled = true
statusLabel.Font = Enum.Font.GothamSemibold
statusLabel.TextXAlignment = Enum.TextXAlignment.Right
statusLabel.Parent = statusFrame

-- Dragging functionality
local dragging = false
local dragStart = nil
local startPos = nil

headerFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

headerFrame.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, 
                                     startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

headerFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Enhanced Notification System
local function showNotification(text, color, duration)
    duration = duration or 3
    
    local notification = Instance.new("Frame")
    notification.Size = UDim2.new(0, 350, 0, 60)
    notification.Position = UDim2.new(0.5, -175, 0, -70)
    notification.BackgroundColor3 = color or Color3.fromRGB(0, 150, 0)
    notification.BorderSizePixel = 0
    notification.BackgroundTransparency = 1
    notification.Parent = screenGui
    
    local notifCorner = Instance.new("UICorner")
    notifCorner.CornerRadius = UDim.new(0, 15)
    notifCorner.Parent = notification
    
    local notifGradient = Instance.new("UIGradient")
    notifGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, color),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(
            math.max(0, color.R * 255 - 40) / 255,
            math.max(0, color.G * 255 - 40) / 255,
            math.max(0, color.B * 255 - 40) / 255
        ))
    })
    notifGradient.Rotation = 45
    notifGradient.Parent = notification
    
    local notifIcon = Instance.new("TextLabel")
    notifIcon.Size = UDim2.new(0, 60, 1, 0)
    notifIcon.BackgroundTransparency = 1
    notifIcon.Text = "‚ú®"
    notifIcon.TextColor3 = Color3.fromRGB(255, 255, 255)
    notifIcon.TextScaled = true
    notifIcon.Font = Enum.Font.GothamBold
    notifIcon.Parent = notification
    
    local notifText = Instance.new("TextLabel")
    notifText.Size = UDim2.new(1, -70, 1, 0)
    notifText.Position = UDim2.new(0, 60, 0, 0)
    notifText.BackgroundTransparency = 1
    notifText.Text = text
    notifText.TextColor3 = Color3.fromRGB(255, 255, 255)
    notifText.TextScaled = true
    notifText.Font = Enum.Font.GothamSemibold
    notifText.TextXAlignment = Enum.TextXAlignment.Left
    notifText.Parent = notification
    
    -- Slide in animation
    local slideIn = TweenService:Create(notification,
        TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
        {
            Position = UDim2.new(0.5, -175, 0, 30),
            BackgroundTransparency = 0
        }
    )
    slideIn:Play()
    
    -- Icon spin
    local iconSpin = TweenService:Create(notifIcon,
        TweenInfo.new(0.8, Enum.EasingStyle.Elastic, Enum.EasingDirection.Out),
        {Rotation = 360}
    )
    iconSpin:Play()
    
    spawn(function()
        wait(duration)
        
        local slideOut = TweenService:Create(notification,
            TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
            {
                Position = UDim2.new(0.5, -175, 0, -70),
                BackgroundTransparency = 1
            }
        )
        slideOut:Play()
        
        slideOut.Completed:Connect(function()
            notification:Destroy()
        end)
    end)
end

-- Advanced Button Creator
local function createAdvancedButton(text, icon, callback, color, parent, layoutOrder)
    local button = Instance.new("TextButton")
    button.BackgroundColor3 = color or Color3.fromRGB(70, 130, 180)
    button.BorderSizePixel = 0
    button.Text = ""
    button.LayoutOrder = layoutOrder or 0
    button.Parent = parent
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 12)
    buttonCorner.Parent = button
    
    -- Gradient effect
    local buttonGradient = Instance.new("UIGradient")
    buttonGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, color),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(
            math.max(0, color.R * 255 - 20) / 255,
            math.max(0, color.G * 255 - 20) / 255,
            math.max(0, color.B * 255 - 20) / 255
        ))
    })
    buttonGradient.Rotation = 45
    buttonGradient.Parent = button
    
    -- Icon
    local iconLabel = Instance.new("TextLabel")
    iconLabel.Size = UDim2.new(1, 0, 0.5, 0)
    iconLabel.BackgroundTransparency = 1
    iconLabel.Text = icon
    iconLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    iconLabel.TextScaled = true
    iconLabel.Font = Enum.Font.GothamBold
    iconLabel.Parent = button
    
    -- Text
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, -4, 0.5, 0)
    textLabel.Position = UDim2.new(0, 2, 0.5, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = text
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    textLabel.TextScaled = true
    textLabel.Font = Enum.Font.Gotham
    textLabel.Parent = button
    
    -- Hover effects
    button.MouseEnter:Connect(function()
        local hoverTween = TweenService:Create(button,
            TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {Size = UDim2.new(0, 135, 0, 45)}
        )
        hoverTween:Play()
        
        local iconHover = TweenService:Create(iconLabel,
            TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
            {Rotation = 10}
        )
        iconHover:Play()
    end)
    
    button.MouseLeave:Connect(function()
        local leaveTween = TweenService:Create(button,
            TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {Size = UDim2.new(0, 130, 0, 40)}
        )
        leaveTween:Play()
        
        local iconLeave = TweenService:Create(iconLabel,
            TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {Rotation = 0}
        )
        iconLeave:Play()
    end)
    
    -- Click effect
    button.MouseButton1Click:Connect(function()
        local clickTween = TweenService:Create(button,
            TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut),
            {Size = UDim2.new(0, 125, 0, 35)}
        )
        clickTween:Play()
        
        local iconClick = TweenService:Create(iconLabel,
            TweenInfo.new(0.2, Enum.EasingStyle.Elastic, Enum.EasingDirection.Out),
            {Size = UDim2.new(1.2, 0, 0.6, 0)}
        )
        iconClick:Play()
        
        iconClick.Completed:Connect(function()
            local returnTween = TweenService:Create(iconLabel,
                TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                {Size = UDim2.new(1, 0, 0.5, 0)}
            )
            returnTween:Play()
        end)
        
        clickTween.Completed:Connect(function()
            local returnTween = TweenService:Create(button,
                TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                {Size = UDim2.new(0, 130, 0, 40)}
            )
            returnTween:Play()
        end)
        
        callback()
    end)
    
    return button
end

-- Graphics Enhancement Functions
local function ultraLighting()
    statusLabel.Text = "üîÑ Applying Ultra..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    Lighting.Brightness = 3
    Lighting.Ambient = Color3.fromRGB(80, 80, 100)
    Lighting.OutdoorAmbient = Color3.fromRGB(150, 150, 180)
    Lighting.Technology = Enum.Technology.Future
    Lighting.GlobalShadows = true
    Lighting.ShadowSoftness = 0.4
    
    -- Ultra ColorCorrection
    local colorCorrection = Lighting:FindFirstChild("UltraColorCorrection") or Instance.new("ColorCorrectionEffect")
    colorCorrection.Name = "UltraColorCorrection"
    colorCorrection.Brightness = 0.2
    colorCorrection.Contrast = 0.4
    colorCorrection.Saturation = 0.5
    colorCorrection.TintColor = Color3.fromRGB(255, 250, 240)
    colorCorrection.Parent = Lighting
    
    -- Ultra Bloom
    local bloom = Lighting:FindFirstChild("UltraBloom") or Instance.new("BloomEffect")
    bloom.Name = "UltraBloom"
    bloom.Intensity = 1
    bloom.Size = 35
    bloom.Threshold = 0.7
    bloom.Parent = Lighting
    
    -- SunRays
    local sunRays = Lighting:FindFirstChild("SunRays") or Instance.new("SunRaysEffect")
    sunRays.Name = "SunRays"
    sunRays.Intensity = 0.4
    sunRays.Spread = 0.6
    sunRays.Parent = Lighting
    
    -- DepthOfField
    local depthOfField = Lighting:FindFirstChild("DepthOfField") or Instance.new("DepthOfFieldEffect")
    depthOfField.Name = "DepthOfField"
    depthOfField.FarIntensity = 0.3
    depthOfField.FocusDistance = 60
    depthOfField.InFocusRadius = 25
    depthOfField.NearIntensity = 0.4
    depthOfField.Parent = Lighting
    
    settings.qualityLevel = "Ultra"
    statusLabel.Text = "‚ú® Ultra Active"
    statusLabel.TextColor3 = Color3.fromRGB(255, 215, 0)
    showNotification("‚ú® Ultra Lighting Activated!", Color3.fromRGB(255, 215, 0))
end

local function cinematicLighting()
    statusLabel.Text = "üîÑ Cinematic Mode..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    Lighting.Brightness = 1.8
    Lighting.Ambient = Color3.fromRGB(40, 45, 60)
    Lighting.OutdoorAmbient = Color3.fromRGB(120, 140, 170)
    Lighting.Technology = Enum.Technology.Future
    Lighting.GlobalShadows = true
    Lighting.ShadowSoftness = 0.3
    
    local colorCorrection = Lighting:FindFirstChild("CinematicGrade") or Instance.new("ColorCorrectionEffect")
    colorCorrection.Name = "CinematicGrade"
    colorCorrection.Brightness = -0.05
    colorCorrection.Contrast = 0.5
    colorCorrection.Saturation = 0.3
    colorCorrection.TintColor = Color3.fromRGB(220, 230, 255)
    colorCorrection.Parent = Lighting
    
    local bloom = Lighting:FindFirstChild("CinematicBloom") or Instance.new("BloomEffect")
    bloom.Name = "CinematicBloom"
    bloom.Intensity = 0.7
    bloom.Size = 25
    bloom.Threshold = 1.1
    bloom.Parent = Lighting
    
    settings.qualityLevel = "Cinematic"
    statusLabel.Text = "üé¨ Cinematic"
    statusLabel.TextColor3 = Color3.fromRGB(138, 43, 226)
    showNotification("üé¨ Cinematic Mode Enabled!", Color3.fromRGB(138, 43, 226))
end

local function enhancedLighting()
    statusLabel.Text = "üîÑ Enhancing..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    Lighting.Brightness = 2.5
    Lighting.Ambient = Color3.fromRGB(60, 60, 80)
    Lighting.OutdoorAmbient = Color3.fromRGB(130, 130, 160)
    Lighting.Technology = Enum.Technology.Future
    Lighting.GlobalShadows = true
    Lighting.ShadowSoftness = 0.2
    
    local colorCorrection = Lighting:FindFirstChild("EnhancedCorrection") or Instance.new("ColorCorrectionEffect")
    colorCorrection.Name = "EnhancedCorrection"
    colorCorrection.Brightness = 0.1
    colorCorrection.Contrast = 0.25
    colorCorrection.Saturation = 0.35
    colorCorrection.Parent = Lighting
    
    local bloom = Lighting:FindFirstChild("EnhancedBloom") or Instance.new("BloomEffect")
    bloom.Name = "EnhancedBloom"
    bloom.Intensity = 0.6
    bloom.Size = 28
    bloom.Threshold = 0.9
    bloom.Parent = Lighting
    
    settings.qualityLevel = "Enhanced"
    statusLabel.Text = "‚úÖ Enhanced"
    statusLabel.TextColor3 = Color3.fromRGB(0, 255, 127)
    showNotification("‚úÖ Enhanced Lighting Applied!", Color3.fromRGB(0, 255, 127))
end

local function realisticLighting()
    statusLabel.Text = "üîÑ Realistic Mode..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    Lighting.Brightness = 2
    Lighting.Ambient = Color3.fromRGB(70, 70, 85)
    Lighting.OutdoorAmbient = Color3.fromRGB(110, 110, 130)
    Lighting.Technology = Enum.Technology.Future
    Lighting.GlobalShadows = true
    Lighting.ShadowSoftness = 0.15
    
    local colorCorrection = Lighting:FindFirstChild("RealisticCorrection") or Instance.new("ColorCorrectionEffect")
    colorCorrection.Name = "RealisticCorrection"
    colorCorrection.Brightness = 0
    colorCorrection.Contrast = 0.15
    colorCorrection.Saturation = 0.1
    colorCorrection.Parent = Lighting
    
    settings.qualityLevel = "Realistic"
    statusLabel.Text = "üåç Realistic"
    statusLabel.TextColor3 = Color3.fromRGB(34, 139, 34)
    showNotification("üåç Realistic Lighting Set!", Color3.fromRGB(34, 139, 34))
end

local function fullbrightMode()
    statusLabel.Text = "üîÑ Fullbright..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    Lighting.Brightness = 10
    Lighting.Ambient = Color3.new(1, 1, 1)
    Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
    Lighting.GlobalShadows = false
    
    settings.qualityLevel = "Fullbright"
    statusLabel.Text = "üí° Fullbright"
    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
    showNotification("üí° Fullbright Mode Activated!", Color3.fromRGB(255, 255, 0))
end

local function nightVision()
    statusLabel.Text = "üîÑ Night Vision..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    Lighting.Brightness = 5
    Lighting.Ambient = Color3.fromRGB(0, 100, 0)
    Lighting.OutdoorAmbient = Color3.fromRGB(0, 150, 0)
    Lighting.Technology = Enum.Technology.Future
    
    local colorCorrection = Lighting:FindFirstChild("NightVision") or Instance.new("ColorCorrectionEffect")
    colorCorrection.Name = "NightVision"
    colorCorrection.Brightness = 0.3
    colorCorrection.Contrast = 0.4
    colorCorrection.Saturation = -0.5
    colorCorrection.TintColor = Color3.fromRGB(0, 255, 0)
    colorCorrection.Parent = Lighting
    
    settings.qualityLevel = "Night Vision"
    statusLabel.Text = "üîç Night Vision"
    statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    showNotification("üîç Night Vision Enabled!", Color3.fromRGB(0, 255, 0))
end

-- Weather Effects
local function rainWeather()
    local colorCorrection = Lighting:FindFirstChild("RainWeather") or Instance.new("ColorCorrectionEffect")
    colorCorrection.Name = "RainWeather"
    colorCorrection.Brightness = -0.25
    colorCorrection.Contrast = 0.1
    colorCorrection.Saturation = -0.4
    colorCorrection.TintColor = Color3.fromRGB(180, 200, 255)
    colorCorrection.Parent = Lighting
    
    Lighting.Ambient = Color3.fromRGB(80, 90, 110)
    Lighting.OutdoorAmbient = Color3.fromRGB(100, 120, 150)
    
    showNotification("üåßÔ∏è Rain Weather Applied!", Color3.fromRGB(70, 130, 180))
end

local function sunsetWeather()
    local colorCorrection = Lighting:FindFirstChild("SunsetWeather") or Instance.new("ColorCorrectionEffect")
    colorCorrection.Name = "SunsetWeather"
    colorCorrection.Brightness = 0.15
    colorCorrection.Contrast = 0.35
    colorCorrection.Saturation = 0.45
    colorCorrection.TintColor = Color3.fromRGB(255, 180, 120)
    colorCorrection.Parent = Lighting
    
    Lighting.Ambient = Color3.fromRGB(180, 120, 80)
    Lighting.OutdoorAmbient = Color3.fromRGB(220, 150, 100)
    
    showNotification("üåÖ Sunset Atmosphere!", Color3.fromRGB(255, 165, 0))
end

-- Performance Enhancement Functions
local function extremePerformance()
    statusLabel.Text = "üîÑ Extreme Boost..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    -- Clear all effects
    for _, effect in pairs(Lighting:GetChildren()) do
        if effect:IsA("PostEffect") then
            effect:Destroy()
        end
    end
    
    Lighting.Technology = Enum.Technology.Compatibility
    Lighting.GlobalShadows = false
    Lighting.Brightness = 1
    Lighting.Ambient = Color3.fromRGB(178, 178, 178)
    Lighting.OutdoorAmbient = Color3.fromRGB(178, 178, 178)
    
    -- Optimize all parts
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("BasePart") then
            obj.Material = Enum.Material.SmoothPlastic
            obj.TopSurface = Enum.SurfaceType.Smooth
            obj.BottomSurface = Enum.SurfaceType.Smooth
            obj.CastShadow = false
        elseif obj:IsA("MeshPart") then
            obj.RenderFidelity = Enum.RenderFidelity.Performance
        elseif obj:IsA("ParticleEmitter") then
            obj.Rate = math.min(obj.Rate, 10)
            obj.Lifetime = NumberRange.new(0.3, 0.8)
        elseif obj:IsA("Fire") or obj:IsA("Smoke") then
            obj.Enabled = false
        end
    end
    
    settings.qualityLevel = "Extreme Performance"
    statusLabel.Text = "üöÄ Extreme Mode"
    statusLabel.TextColor3 = Color3.fromRGB(255, 69, 0)
    showNotification("üöÄ Extreme Performance Boost!", Color3.fromRGB(255, 69, 0))
end

local function performanceMode()
    statusLabel.Text = "üîÑ Performance..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    -- Remove heavy effects
    for _, effect in pairs(Lighting:GetChildren()) do
        if effect:IsA("BloomEffect") or effect:IsA("SunRaysEffect") or effect:IsA("DepthOfFieldEffect") then
            effect:Destroy()
        end
    end
    
    Lighting.Technology = Enum.Technology.ShadowMap
    Lighting.GlobalShadows = true
    Lighting.ShadowSoftness = 0
    Lighting.Brightness = 1.5
    
    -- Optimize particles
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("ParticleEmitter") then
            obj.Rate = math.min(obj.Rate, 25)
        elseif obj:IsA("MeshPart") then
            obj.RenderFidelity = Enum.RenderFidelity.Performance
        end
    end
    
    settings.qualityLevel = "Performance"
    statusLabel.Text = "‚ö° Performance"
    statusLabel.TextColor3 = Color3.fromRGB(255, 140, 0)
    showNotification("‚ö° Performance Mode Active!", Color3.fromRGB(255, 140, 0))
end

local function fpsBoostMode()
    statusLabel.Text = "üîÑ FPS Boost..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    -- Texture optimization
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Texture") or obj:IsA("Decal") then
            obj.StudsPerTileU = obj.StudsPerTileU * 1.5
            obj.StudsPerTileV = obj.StudsPerTileV * 1.5
        elseif obj:IsA("SurfaceGui") then
            obj.Face = Enum.NormalId.Front
        elseif obj:IsA("ParticleEmitter") then
            obj.Rate = math.min(obj.Rate, 20)
            obj.Lifetime = NumberRange.new(0.5, 1.2)
        end
    end
    
    -- Sound optimization
    SoundService.AmbientReverb = Enum.ReverbType.NoReverb
    for _, sound in pairs(Workspace:GetDescendants()) do
        if sound:IsA("Sound") and sound.Volume > 0.6 then
            sound.Volume = 0.4
        end
    end
    
    settings.qualityLevel = "FPS Boost"
    statusLabel.Text = "üìà FPS Boost"
    statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    showNotification("üìà FPS Boost Applied!", Color3.fromRGB(0, 255, 0))
end

local function lowEndMode()
    statusLabel.Text = "üîÑ Low-End Mode..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    -- Minimal settings
    Lighting.Technology = Enum.Technology.Compatibility
    Lighting.GlobalShadows = false
    Lighting.Brightness = 1
    
    -- Remove all effects
    for _, effect in pairs(Lighting:GetChildren()) do
        if effect:IsA("PostEffect") then
            effect:Destroy()
        end
    end
    
    -- Aggressive optimization
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("BasePart") then
            obj.Material = Enum.Material.Plastic
            obj.CastShadow = false
            obj.CanCollide = obj.CanCollide -- Keep collision but optimize
        elseif obj:IsA("MeshPart") then
            obj.RenderFidelity = Enum.RenderFidelity.Performance
        elseif obj:IsA("UnionOperation") then
            obj.UsePartColor = true
        elseif obj:IsA("ParticleEmitter") then
            obj.Enabled = false
        elseif obj:IsA("Fire") or obj:IsA("Smoke") or obj:IsA("Explosion") then
            obj.Enabled = false
        end
    end
    
    settings.qualityLevel = "Low-End"
    statusLabel.Text = "üì± Low-End"
    statusLabel.TextColor3 = Color3.fromRGB(128, 128, 128)
    showNotification("üì± Low-End Mode Optimized!", Color3.fromRGB(128, 128, 128))
end

local function antiLag()
    statusLabel.Text = "üîÑ Anti-Lag..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    local lagSources = 0
    
    -- Detect and fix lag sources
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Script") and obj.Disabled == false and not obj:IsDescendantOf(player.PlayerGui) then
            lagSources = lagSources + 1
        elseif obj:IsA("ParticleEmitter") and obj.Rate > 100 then
            obj.Rate = 30
            lagSources = lagSources + 1
        elseif obj:IsA("Sound") and obj.Volume > 0.7 and not obj.Playing then
            obj.Volume = 0.4
            lagSources = lagSources + 1
        elseif obj:IsA("Explosion") then
            obj.Visible = false
            lagSources = lagSources + 1
        elseif obj:IsA("Fire") and obj.Size > 10 then
            obj.Size = 5
            lagSources = lagSources + 1
        end
    end
    
    -- Memory cleanup
    wait(0.5)
    for i = 1, 5 do
        game:GetService("RunService").Heartbeat:Wait()
    end
    
    settings.qualityLevel = "Anti-Lag"
    statusLabel.Text = "üõ°Ô∏è Anti-Lag"
    statusLabel.TextColor3 = Color3.fromRGB(0, 191, 255)
    showNotification("üõ°Ô∏è Anti-Lag: " .. lagSources .. " sources fixed!", Color3.fromRGB(0, 191, 255))
end

local function resetAll()
    statusLabel.Text = "üîÑ Resetting..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
    
    -- Reset lighting to default
    Lighting.Brightness = 1
    Lighting.Ambient = Color3.fromRGB(70, 70, 70)
    Lighting.OutdoorAmbient = Color3.fromRGB(70, 70, 70)
    Lighting.Technology = Enum.Technology.Compatibility
    Lighting.GlobalShadows = false
    Lighting.ShadowSoftness = 0.2
    
    -- Remove all custom effects
    for _, effect in pairs(Lighting:GetChildren()) do
        if effect:IsA("PostEffect") and (effect.Name:find("Ultra") or effect.Name:find("Enhanced") or 
           effect.Name:find("Cinematic") or effect.Name:find("Weather") or effect.Name:find("Night")) then
            effect:Destroy()
        end
    end
    
    settings.qualityLevel = "Default"
    statusLabel.Text = "‚ö° Ready"
    statusLabel.TextColor3 = Color3.fromRGB(0, 255, 127)
    showNotification("üîÑ All Settings Reset!", Color3.fromRGB(255, 165, 0))
end

-- Tab switching functionality
local function switchToTab(tabName)
    settings.currentTab = tabName
    
    if tabName == "enhance" then
        enhanceTab.BackgroundColor3 = Color3.fromRGB(50, 200, 100)
        enhanceTab.TextColor3 = Color3.fromRGB(255, 255, 255)
        performanceTab.BackgroundColor3 = Color3.fromRGB(100, 100, 120)
        performanceTab.TextColor3 = Color3.fromRGB(200, 200, 200)
        
        enhanceContent.Visible = true
        performanceContent.Visible = false
    else
        performanceTab.BackgroundColor3 = Color3.fromRGB(255, 100, 50)
        performanceTab.TextColor3 = Color3.fromRGB(255, 255, 255)
        enhanceTab.BackgroundColor3 = Color3.fromRGB(100, 100, 120)
        enhanceTab.TextColor3 = Color3.fromRGB(200, 200, 200)
        
        performanceContent.Visible = true
        enhanceContent.Visible = false
    end
end

-- Tab click events
enhanceTab.MouseButton1Click:Connect(function()
    if settings.currentTab ~= "enhance" then
        switchToTab("enhance")
        
        local tabTween = TweenService:Create(enhanceTab,
            TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
            {Size = UDim2.new(0.48, 5, 1, 5)}
        )
        tabTween:Play()
        
        tabTween.Completed:Connect(function()
            local returnTween = TweenService:Create(enhanceTab,
                TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                {Size = UDim2.new(0.48, 0, 1, 0)}
            )
            returnTween:Play()
        end)
    end
end)

performanceTab.MouseButton1Click:Connect(function()
    if settings.currentTab ~= "performance" then
        switchToTab("performance")
        
        local tabTween = TweenService:Create(performanceTab,
            TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
            {Size = UDim2.new(0.48, 5, 1, 5)}
        )
        tabTween:Play()
        
        tabTween.Completed:Connect(function()
            local returnTween = TweenService:Create(performanceTab,
                TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                {Size = UDim2.new(0.48, 0, 1, 0)}
            )
            returnTween:Play()
        end)
    end
end)

-- Create Enhanced Graphics Buttons (Tab 1)
createAdvancedButton("Ultra", "‚ú®", ultraLighting, Color3.fromRGB(255, 215, 0), enhanceContent, 1)
createAdvancedButton("Cinematic", "üé¨", cinematicLighting, Color3.fromRGB(138, 43, 226), enhanceContent, 2)
createAdvancedButton("Enhanced", "üåü", enhancedLighting, Color3.fromRGB(70, 130, 180), enhanceContent, 3)
createAdvancedButton("Realistic", "üåç", realisticLighting, Color3.fromRGB(34, 139, 34), enhanceContent, 4)
createAdvancedButton("Fullbright", "üí°", fullbrightMode, Color3.fromRGB(255, 255, 0), enhanceContent, 5)
createAdvancedButton("Night Vision", "üîç", nightVision, Color3.fromRGB(0, 255, 0), enhanceContent, 6)
createAdvancedButton("Rain", "üåßÔ∏è", rainWeather, Color3.fromRGB(70, 130, 180), enhanceContent, 7)
createAdvancedButton("Sunset", "üåÖ", sunsetWeather, Color3.fromRGB(255, 165, 0), enhanceContent, 8)

-- Create Performance Buttons (Tab 2)
createAdvancedButton("Extreme", "üöÄ", extremePerformance, Color3.fromRGB(255, 69, 0), performanceContent, 1)
createAdvancedButton("Performance", "‚ö°", performanceMode, Color3.fromRGB(255, 140, 0), performanceContent, 2)
createAdvancedButton("FPS Boost", "üìà", fpsBoostMode, Color3.fromRGB(0, 255, 0), performanceContent, 3)
createAdvancedButton("Low-End", "üì±", lowEndMode, Color3.fromRGB(128, 128, 128), performanceContent, 4)
createAdvancedButton("Anti-Lag", "üõ°Ô∏è", antiLag, Color3.fromRGB(0, 191, 255), performanceContent, 5)
createAdvancedButton("Reset All", "üîÑ", resetAll, Color3.fromRGB(255, 165, 0), performanceContent, 6)

-- Update canvas sizes
enhanceContent.CanvasSize = UDim2.new(0, 0, 0, math.ceil(8/3) * 48) -- 8 buttons, 3 columns
performanceContent.CanvasSize = UDim2.new(0, 0, 0, math.ceil(6/3) * 48) -- 6 buttons, 3 columns

-- FPS Monitor
local fps = 0
local frameTime = tick()
local frameCount = 0

fpsMonitor = RunService.Heartbeat:Connect(function()
    frameCount = frameCount + 1
    if frameCount >= 30 then
        fps = math.floor(30 / (tick() - frameTime))
        frameTime = tick()
        frameCount = 0
        
        fpsLabel.Text = "üìä FPS: " .. fps
        
        -- Dynamic FPS coloring
        if fps >= 50 then
            fpsLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
        elseif fps >= 35 then
            fpsLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
        elseif fps >= 20 then
            fpsLabel.TextColor3 = Color3.fromRGB(255, 165, 0)
        else
            fpsLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
        end
    end
end)

-- Close/Hide UI System
closeButton.MouseButton1Click:Connect(function()
    settings.uiVisible = not settings.uiVisible
    
    if not settings.uiVisible then
        -- Hide UI with animation
        local hideTween = TweenService:Create(mainFrame,
            TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.In),
            {
                Position = UDim2.new(0.5, -225, 0, -350),
                Size = UDim2.new(0, 400, 0, 280)
            }
        )
        hideTween:Play()
        
        hideTween.Completed:Connect(function()
            mainFrame.Visible = false
        end)
        
        -- Create floating indicator
        local floatingButton = Instance.new("TextButton")
        floatingButton.Size = UDim2.new(0, 50, 0, 50)
        floatingButton.Position = UDim2.new(1, -60, 0, 10)
        floatingButton.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
        floatingButton.BorderSizePixel = 0
        floatingButton.Text = "üéÆ"
        floatingButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        floatingButton.TextScaled = true
        floatingButton.Font = Enum.Font.GothamBold
        floatingButton.BackgroundTransparency = 0.2
        floatingButton.Parent = screenGui
        
        local floatingCorner = Instance.new("UICorner")
        floatingCorner.CornerRadius = UDim.new(0, 25)
        floatingCorner.Parent = floatingButton
        
        -- Floating button animations
        local floatTween = TweenService:Create(floatingButton,
            TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true),
            {
                Position = UDim2.new(1, -60, 0, 20),
                BackgroundTransparency = 0.5
            }
        )
        floatTween:Play()
        
        -- Click to show UI again
        floatingButton.MouseButton1Click:Connect(function()
            settings.uiVisible = true
            mainFrame.Visible = true
            
            local showTween = TweenService:Create(mainFrame,
                TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
                {
                    Position = UDim2.new(0.5, -225, 0.5, -160),
                    Size = UDim2.new(0, 450, 0, 320)
                }
            )
            showTween:Play()
            
            floatTween:Cancel()
            floatingButton:Destroy()
            showNotification("üëÅÔ∏è UI Restored!", Color3.fromRGB(0, 255, 127))
        end)
        
        showNotification("üîç UI Hidden - All functions active!", Color3.fromRGB(255, 165, 0))
    end
end)

-- Background optimization (runs even when UI hidden)
spawn(function()
    while true do
        wait(15)
        if settings.fpsBoost and fps < 25 then
            -- Auto performance boost when FPS is low
            for _, obj in pairs(Workspace:GetDescendants()) do
                if obj:IsA("ParticleEmitter") and obj.Rate > 50 then
                    obj.Rate = 20
                elseif obj:IsA("Sound") and obj.Volume > 0.5 and not obj.Playing then
                    obj.Volume = 0.3
                end
            end
        end
    end
end)

-- Hotkeys (work even when UI hidden)
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.F1 then
        ultraLighting()
    elseif input.KeyCode == Enum.KeyCode.F2 then
        extremePerformance()
    elseif input.KeyCode == Enum.KeyCode.F3 then
        antiLag()
    elseif input.KeyCode == Enum.KeyCode.F4 then
        closeButton.MouseButton1Click:Fire()
    elseif input.KeyCode == Enum.KeyCode.F5 then
        resetAll()
    elseif input.KeyCode == Enum.KeyCode.F6 then
        fullbrightMode()
    elseif input.KeyCode == Enum.KeyCode.F7 then
        fpsBoostMode()
    elseif input.KeyCode == Enum.KeyCode.F8 then
        switchToTab(settings.currentTab == "enhance" and "performance" or "enhance")
    end
end)

-- Auto-enhancement disabled - let users choose
-- spawn(function()
--     wait(2)
--     enhancedLighting()
--     showNotification("ü§ñ Auto-enhancement activated!", Color3.fromRGB(0, 255, 127))
-- end)

-- Welcome sequence
spawn(function()
    wait(1)
    showNotification("üéÆ Graphics Master V4 Ready!", Color3.fromRGB(70, 130, 180), 4)
    wait(2)
    showNotification("‚ú® Choose your graphics mode!", Color3.fromRGB(255, 215, 0), 3)
    wait(1)
    showNotification("‚å®Ô∏è Hotkeys F1-F8 | ‚úï to hide UI", Color3.fromRGB(0, 191, 255), 3)
end)

-- Cleanup on exit
game.Players.PlayerRemoving:Connect(function(plr)
    if plr == player then
        if fpsMonitor then fpsMonitor:Disconnect() end
    end
end)

-- Final logs
print("üéÆ Graphics Master V4.0 - Beautiful Dual Tab Interface")
print("‚ú® Tab 1: TƒÇNG ƒê·ªí H·ªåA - Ultra, Cinematic, Enhanced, Realistic, Fullbright, Night Vision, Weather")
print("üöÄ Tab 2: GI·∫¢M ƒê·ªí H·ªåA - Extreme, Performance, FPS Boost, Low-End, Anti-Lag, Reset")
print("üé® Modern UI with glassmorphism, smooth animations, and glowing effects")
print("‚å®Ô∏è  Enhanced Hotkeys: F1=Ultra, F2=Extreme, F3=Anti-Lag, F4=Toggle UI, F5=Reset, F6=Fullbright, F7=FPS Boost, F8=Switch Tab")
print("üîÑ Background processes continue running when UI is hidden")
print("üìä Real-time FPS monitoring with color indicators")
print("üéØ Click ‚úï to hide UI, click floating üéÆ to restore")
print("üë§ No auto-enhancement - users choose their preferred settings")
print("üåü Made by Graphics Enhancement Team - V4.0 Dual Tab Edition")