-- Search bar for scripts
local searchFrame = Instance.new("Frame")
searchFrame.Name = "SearchFrame"
searchFrame.Size = UDim2.new(1, -10, 0, 25)
searchFrame.Position = UDim2.new(0, 5, 0, 40)
searchFrame.BackgroundColor3 = Color3.new(1, 1, 1)
searchFrame.BorderSizePixel = 0
searchFrame.Visible = false
searchFrame.Parent = mainFrame

local searchCorner = Instance.new("UICorner")
searchCorner.CornerRadius = UDim.new(0, 6)
searchCorner.Parent = searchFrame

local searchBox = Instance.new("TextBox")
searchBox.Name = "SearchBox"
searchBox.Size = UDim2.new(1, -30, 1, -4)
searchBox.Position = UDim2.new(0, 8, 0, 2)
searchBox.BackgroundTransparency = 1
searchBox.PlaceholderText = "üîç T√¨m ki·∫øm script..."
searchBox.Text = ""
searchBox.TextColor3 = Color3.new(0.2, 0.2, 0.2)
searchBox.TextSize = 12
searchBox.Font = Enum.Font.Gotham
searchBox.TextXAlignment = Enum.TextXAlignment.Left
searchBox.Parent = searchFrame

local clearButton = Instance.new("TextButton")
clearButton.Name = "ClearButton"
clearButton.Size = UDim2.new(0, 20, 0, 20)
clearButton.Position = UDim2.new(1, -22, 0, 2.5)
clearButton.BackgroundColor3 = Color3.new(0.9, 0.9, 0.9)
clearButton.Text = "‚úï"
clearButton.TextColor3 = Color3.new(0.5, 0.5, 0.5)
clearButton.TextSize = 12
clearButton.Font = Enum.Font.GothamBold
clearButton.Parent = searchFrame

local clearCorner = Instance.new("UICorner")
clearCorner.CornerRadius = UDim.new(1, 0)
clearCorner.Parent = clearButton-- Mila UI Script for Roblox - Fixed Version
-- T·∫°o b·ªüi: Mila
-- T√≠nh nƒÉng: Speed, Jump, Fly, Noclip, Teleport, InfiniteJump

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

-- Variables
local noclip = false
local flying = false
local originalWalkSpeed = 16
local originalJumpPower = 50
local noclipConnection
local flyConnection
local bodyVelocity
local bodyAngularVelocity

-- Safe GUI creation function
local function createScreenGui(name)
    local existingGui = CoreGui:FindFirstChild(name)
    if existingGui then
        existingGui:Destroy()
    end
    
    local gui = Instance.new("ScreenGui")
    gui.Name = name
    gui.Parent = CoreGui
    gui.ResetOnSpawn = false
    return gui
end

-- Loading Screen
local loadingGui = createScreenGui("MilaLoading")

local loadingFrame = Instance.new("Frame")
loadingFrame.Size = UDim2.new(1, 0, 1, 0)
loadingFrame.BackgroundColor3 = Color3.new(0.15, 0.15, 0.2)
loadingFrame.BorderSizePixel = 0
loadingFrame.Parent = loadingGui

local loadingTitle = Instance.new("TextLabel")
loadingTitle.Size = UDim2.new(0, 200, 0, 50)
loadingTitle.Position = UDim2.new(0.5, -100, 0.5, -50)
loadingTitle.BackgroundTransparency = 1
loadingTitle.Text = "üíñ Mila UI üíñ"
loadingTitle.TextColor3 = Color3.new(1, 1, 1)
loadingTitle.TextSize = 24
loadingTitle.Font = Enum.Font.GothamBold
loadingTitle.Parent = loadingFrame

local progressBar = Instance.new("Frame")
progressBar.Size = UDim2.new(0, 300, 0, 6)
progressBar.Position = UDim2.new(0.5, -150, 0.5, 10)
progressBar.BackgroundColor3 = Color3.new(0.3, 0.3, 0.4)
progressBar.BorderSizePixel = 0
progressBar.Parent = loadingFrame

local progressBarCorner = Instance.new("UICorner")
progressBarCorner.CornerRadius = UDim.new(0, 3)
progressBarCorner.Parent = progressBar

local progressFill = Instance.new("Frame")
progressFill.Size = UDim2.new(0, 0, 1, 0)
progressFill.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
progressFill.BorderSizePixel = 0
progressFill.Parent = progressBar

local progressFillCorner = Instance.new("UICorner")
progressFillCorner.CornerRadius = UDim.new(0, 3)
progressFillCorner.Parent = progressFill

local loadingText = Instance.new("TextLabel")
loadingText.Size = UDim2.new(0, 300, 0, 30)
loadingText.Position = UDim2.new(0.5, -150, 0.5, 30)
loadingText.BackgroundTransparency = 1
loadingText.Text = "ƒêang t·∫£i..."
loadingText.TextColor3 = Color3.new(0.8, 0.8, 0.8)
loadingText.TextSize = 14
loadingText.Font = Enum.Font.Gotham
loadingText.Parent = loadingFrame

-- Progress Animation with proper error handling
local function animateLoading()
    local steps = {"ƒêang kh·ªüi t·∫°o...", "ƒêang t·∫£i giao di·ªán...", "ƒêang chu·∫©n b·ªã t√≠nh nƒÉng...", "Ho√†n th√†nh!"}
    local stepSize = 100 / #steps
    
    for i = 1, 100 do
        if not loadingGui or not loadingGui.Parent then break end
        
        task.wait(0.02) -- Use task.wait instead of wait
        
        if progressFill and progressFill.Parent then
            progressFill.Size = UDim2.new(i/100, 0, 1, 0)
        end
        
        if loadingText and loadingText.Parent then
            local stepIndex = math.min(math.floor(i / stepSize) + 1, #steps)
            loadingText.Text = steps[stepIndex]
        end
    end
    
    task.wait(0.5)
    if loadingGui then
        loadingGui:Destroy()
    end
end

-- Start loading animation
task.spawn(animateLoading)

-- Main UI Creation
local screenGui = createScreenGui("MilaUI")

-- Main Frame (Larger size for better text display)
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 320, 0, 220)
mainFrame.Position = UDim2.new(0.5, -160, 0.5, -110)
mainFrame.BackgroundColor3 = Color3.new(0.95, 0.95, 0.95)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Visible = false
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 12)
mainCorner.Parent = mainFrame

-- Tab Container
local tabContainer = Instance.new("Frame")
tabContainer.Size = UDim2.new(1, 0, 0, 35)
tabContainer.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
tabContainer.BorderSizePixel = 0
tabContainer.Parent = mainFrame

local tabCorner = Instance.new("UICorner")
tabCorner.CornerRadius = UDim.new(0, 12)
tabCorner.Parent = tabContainer

-- Tab Bottom Frame (to square bottom corners)
local tabBottom = Instance.new("Frame")
tabBottom.Size = UDim2.new(1, 0, 0, 12)
tabBottom.Position = UDim2.new(0, 0, 1, -12)
tabBottom.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
tabBottom.BorderSizePixel = 0
tabBottom.Parent = tabContainer

-- Home Tab
local homeTab = Instance.new("TextButton")
homeTab.Name = "HomeTab"
homeTab.Size = UDim2.new(0, 120, 0, 30)
homeTab.Position = UDim2.new(0, 10, 0, 2.5)
homeTab.BackgroundColor3 = Color3.new(1, 1, 1)
homeTab.Text = "Home"
homeTab.TextColor3 = Color3.new(0.2, 0.2, 0.2)
homeTab.TextSize = 14
homeTab.Font = Enum.Font.GothamBold
homeTab.Parent = tabContainer

local homeTabCorner = Instance.new("UICorner")
homeTabCorner.CornerRadius = UDim.new(0, 8)
homeTabCorner.Parent = homeTab

-- Script Tab
local scriptTab = Instance.new("TextButton")
scriptTab.Name = "ScriptTab"
scriptTab.Size = UDim2.new(0, 120, 0, 30)
scriptTab.Position = UDim2.new(0, 140, 0, 2.5)
scriptTab.BackgroundColor3 = Color3.new(0.8, 0.8, 0.8)
scriptTab.Text = "Script"
scriptTab.TextColor3 = Color3.new(0.4, 0.4, 0.4)
scriptTab.TextSize = 14
scriptTab.Font = Enum.Font.Gotham
scriptTab.Parent = tabContainer

local scriptTabCorner = Instance.new("UICorner")
scriptTabCorner.CornerRadius = UDim.new(0, 8)
scriptTabCorner.Parent = scriptTab

-- Close Button
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 20, 0, 20)
closeButton.Position = UDim2.new(1, -25, 0, 7.5)
closeButton.BackgroundColor3 = Color3.new(1, 0.3, 0.3)
closeButton.Text = "‚úï"
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.TextSize = 12
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = tabContainer

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(1, 0)
closeCorner.Parent = closeButton

-- Toggle Button (when closed)
local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Size = UDim2.new(0, 60, 0, 25)
toggleButton.Position = UDim2.new(0, 10, 0, 10)
toggleButton.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
toggleButton.Text = "Mila"
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.TextSize = 12
toggleButton.Font = Enum.Font.GothamBold
toggleButton.Visible = false
toggleButton.Parent = screenGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 8)
toggleCorner.Parent = toggleButton

-- Home Content Frame
local homeContent = Instance.new("ScrollingFrame")
homeContent.Name = "HomeContent"
homeContent.Size = UDim2.new(1, -10, 1, -45)
homeContent.Position = UDim2.new(0, 5, 0, 40)
homeContent.BackgroundTransparency = 1
homeContent.ScrollBarThickness = 4
homeContent.CanvasSize = UDim2.new(0, 0, 0, 300)
homeContent.Parent = mainFrame

-- Script Content Frame with search
local scriptContent = Instance.new("ScrollingFrame")
scriptContent.Name = "ScriptContent"
scriptContent.Size = UDim2.new(1, -10, 1, -75) -- Adjusted for search bar
scriptContent.Position = UDim2.new(0, 5, 0, 70) -- Adjusted for search bar
scriptContent.BackgroundTransparency = 1
scriptContent.ScrollBarThickness = 4
scriptContent.CanvasSize = UDim2.new(0, 0, 0, 800)
scriptContent.Visible = false
scriptContent.Parent = mainFrame

-- Button Creation Function with better text size
local function createButton(parent, name, text, position, size, callback)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Size = size or UDim2.new(0, 120, 0, 25)
    button.Position = position
    button.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
    button.Text = text
    button.TextColor3 = Color3.new(1, 1, 1)
    button.TextSize = 12
    button.Font = Enum.Font.GothamBold
    button.TextScaled = true -- Auto scale text
    button.Parent = parent
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 6)
    buttonCorner.Parent = button
    
    -- Add text size constraints
    local textSizeConstraint = Instance.new("UITextSizeConstraint")
    textSizeConstraint.MaxTextSize = 12
    textSizeConstraint.MinTextSize = 8
    textSizeConstraint.Parent = button
    
    button.MouseButton1Click:Connect(callback)
    
    -- Hover effect
    button.MouseEnter:Connect(function()
        button.BackgroundColor3 = Color3.new(1, 0.5, 0.8)
    end)
    
    button.MouseLeave:Connect(function()
        button.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
    end)
    
    return button
end

-- Input Creation Function with better text size
local function createInput(parent, name, placeholder, position, size)
    local input = Instance.new("TextBox")
    input.Name = name
    input.Size = size or UDim2.new(0, 60, 0, 20)
    input.Position = position
    input.BackgroundColor3 = Color3.new(1, 1, 1)
    input.Text = ""
    input.PlaceholderText = placeholder
    input.TextColor3 = Color3.new(0.2, 0.2, 0.2)
    input.TextSize = 11
    input.Font = Enum.Font.Gotham
    input.TextScaled = false
    input.Parent = parent
    
    local inputCorner = Instance.new("UICorner")
    inputCorner.CornerRadius = UDim.new(0, 4)
    inputCorner.Parent = input
    
    -- Add padding for better text display
    local padding = Instance.new("UIPadding")
    padding.PaddingLeft = UDim.new(0, 4)
    padding.PaddingRight = UDim.new(0, 4)
    padding.Parent = input
    
    return input
end

-- Label Creation Function with better text size
local function createLabel(parent, text, position, size)
    local label = Instance.new("TextLabel")
    label.Size = size or UDim2.new(0, 120, 0, 15)
    label.Position = position
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = Color3.new(0.3, 0.3, 0.3)
    label.TextSize = 11
    label.Font = Enum.Font.GothamBold
    label.TextScaled = false
    label.Parent = parent
    
    return label
end

-- Fly function
local function toggleFly()
    if not character or not character:FindFirstChild("HumanoidRootPart") then
        return
    end
    
    flying = not flying
    
    if flying then
        local rootPart = character.HumanoidRootPart
        
        bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
        bodyVelocity.Velocity = Vector3.new(0, 0, 0)
        bodyVelocity.Parent = rootPart
        
        bodyAngularVelocity = Instance.new("BodyAngularVelocity")
        bodyAngularVelocity.MaxTorque = Vector3.new(4000, 4000, 4000)
        bodyAngularVelocity.AngularVelocity = Vector3.new(0, 0, 0)
        bodyAngularVelocity.Parent = rootPart
        
        flyConnection = RunService.Heartbeat:Connect(function()
            if not flying or not character or not rootPart or not rootPart.Parent then
                return
            end
            
            local camera = workspace.CurrentCamera
            local humanoidRootPart = character.HumanoidRootPart
            
            local moveVector = humanoid.MoveDirection
            local speed = 50
            
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
                speed = 100
            end
            
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                bodyVelocity.Velocity = bodyVelocity.Velocity + Vector3.new(0, speed, 0)
            elseif UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
                bodyVelocity.Velocity = bodyVelocity.Velocity + Vector3.new(0, -speed, 0)
            end
            
            if moveVector.Magnitude > 0 then
                local lookDirection = camera.CFrame.LookVector
                local rightDirection = camera.CFrame.RightVector
                
                bodyVelocity.Velocity = (lookDirection * moveVector.Z + rightDirection * moveVector.X) * speed
            else
                bodyVelocity.Velocity = Vector3.new(0, bodyVelocity.Velocity.Y, 0)
            end
            
            if not UserInputService:IsKeyDown(Enum.KeyCode.Space) and not UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
                bodyVelocity.Velocity = Vector3.new(bodyVelocity.Velocity.X, 0, bodyVelocity.Velocity.Z)
            end
        end)
    else
        if bodyVelocity then
            bodyVelocity:Destroy()
            bodyVelocity = nil
        end
        if bodyAngularVelocity then
            bodyAngularVelocity:Destroy()
            bodyAngularVelocity = nil
        end
        if flyConnection then
            flyConnection:Disconnect()
            flyConnection = nil
        end
    end
end

-- HOME TAB CONTENT
-- Speed Controls
local speedLabel = createLabel(homeContent, "Speed:", UDim2.new(0, 10, 0, 10))
local speedInput = createInput(homeContent, "SpeedInput", "16", UDim2.new(0, 60, 0, 10), UDim2.new(0, 50, 0, 20))
createButton(homeContent, "SpeedBtn", "Apply", UDim2.new(0, 120, 0, 10), UDim2.new(0, 50, 0, 20), function()
    local speed = tonumber(speedInput.Text) or 16
    if humanoid then
        humanoid.WalkSpeed = math.max(0, math.min(speed, 1000)) -- Clamp between 0 and 1000
    end
end)

-- Jump Controls
local jumpLabel = createLabel(homeContent, "Jump:", UDim2.new(0, 10, 0, 40))
local jumpInput = createInput(homeContent, "JumpInput", "50", UDim2.new(0, 60, 0, 40), UDim2.new(0, 50, 0, 20))
createButton(homeContent, "JumpBtn", "Apply", UDim2.new(0, 120, 0, 40), UDim2.new(0, 50, 0, 20), function()
    local jump = tonumber(jumpInput.Text) or 50
    if humanoid then
        humanoid.JumpPower = math.max(0, math.min(jump, 1000)) -- Clamp between 0 and 1000
    end
end)

-- Main Buttons
createButton(homeContent, "NoclipBtn", "üëª Noclip", UDim2.new(0, 10, 0, 70), UDim2.new(0, 75, 0, 25), function()
    noclip = not noclip
    
    if noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = nil
    end
    
    if noclip then
        noclipConnection = RunService.Stepped:Connect(function()
            if not noclip or not character then
                if noclipConnection then
                    noclipConnection:Disconnect()
                    noclipConnection = nil
                end
                return
            end
            
            for _, part in pairs(character:GetChildren()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end)
    else
        for _, part in pairs(character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.CanCollide = true
            end
        end
    end
end)

createButton(homeContent, "FlyBtn", "üïäÔ∏è Fly", UDim2.new(0, 95, 0, 70), UDim2.new(0, 75, 0, 25), function()
    toggleFly()
end)

createButton(homeContent, "ResetCamBtn", "üì∑ Reset Cam", UDim2.new(0, 10, 0, 105), UDim2.new(0, 75, 0, 25), function()
    if workspace.CurrentCamera and character and humanoid then
        workspace.CurrentCamera.CameraSubject = humanoid
        workspace.CurrentCamera.CameraType = Enum.CameraType.Custom
    end
end)

createButton(homeContent, "ResetBtn", "üîÑ Reset All", UDim2.new(0, 95, 0, 105), UDim2.new(0, 75, 0, 25), function()
    -- Reset speed and jump
    if humanoid then
        humanoid.WalkSpeed = originalWalkSpeed
        humanoid.JumpPower = originalJumpPower
    end
    
    -- Disable noclip
    noclip = false
    if noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = nil
    end
    
    -- Disable fly
    flying = false
    if flyConnection then
        flyConnection:Disconnect()
        flyConnection = nil
    end
    if bodyVelocity then
        bodyVelocity:Destroy()
        bodyVelocity = nil
    end
    if bodyAngularVelocity then
        bodyAngularVelocity:Destroy()
        bodyAngularVelocity = nil
    end
    
    -- Reset UI inputs
    speedInput.Text = ""
    jumpInput.Text = ""
    
    -- Reset camera
    if workspace.CurrentCamera and character and humanoid then
        workspace.CurrentCamera.CameraSubject = humanoid
    end
    
    -- Reset collision
    if character then
        for _, part in pairs(character:GetChildren()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.CanCollide = true
            end
        end
    end
end)

-- SCRIPT TAB CONTENT
-- Scripts data
local scriptsData = {
    {name = "Infinity Yield", code = "loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()"},
    {name = "Airflow", code = "loadstring(game:HttpGet(\"https://api.luarmor.net/files/v3/loaders/255ac567ced3dcb9e69aa7e44c423f19.lua\"))()"},
    {name = "H4X", code = "loadstring(game:HttpGet(\"https://raw.githubusercontent.com/H4xScripts/Loader/refs/heads/main/loader.lua\", true))()"},
    {name = "R15 Emote", code = "loadstring(game:HttpGetAsync(\"https://gist.githubusercontent.com/RedZenXYZ/3da6af1961efa275de6c3c2a6dbace03/raw/bb027f99cec0ea48ef9c5eabfb9116ddff20633d/FE%2520Emotes%2520Gui\"))()"},
    {name = "Skull Hub", code = "loadstring(game:HttpGet('https://raw.githubusercontent.com/hungquan99/SkullHub/main/loader.lua'))()"},
    {name = "Nameless Admin", code = "loadstring(game:HttpGet(\"https://rawscripts.net/raw/Universal-Script-nameless-admin-15646\"))()"},
    {name = "NatHub", code = "loadstring(game:HttpGet(\"https://raw.githubusercontent.com/ArdyBotzz/NatHub/refs/heads/master/NatHub.lua\"))()"},
    {name = "Arceus X", code = "loadstring(game:HttpGet(\"https://raw.githubusercontent.com/AZYsGithub/chillz-workshop/main/Arceus%20X%20V3\"))()"},
    {name = "Shader", code = "loadstring(game:HttpGet('https://raw.githubusercontent.com/randomstring0/pshade-ultimate/refs/heads/main/src/cd.lua'))()"},
    {name = "Native", code = "loadstring(game:HttpGet(\"https://getnative.cc/script/loader\"))()"},
    {name = "Nolag", code = "loadstring(game:HttpGetAsync(\"https://raw.githubusercontent.com/NoLag-id/No-Lag-HUB/refs/heads/main/Loader/LoaderV1.lua\"))()"},
    {name = "Limit Hub", code = "loadstring(game:HttpGet(('https://raw.githubusercontent.com/FakeModz/LimitHub/refs/heads/main/LimitHub_Loader.lua')))()"},
    {name = "Speed Hub X", code = "loadstring(game:HttpGet(\"https://rawscripts.net/raw/Grow-a-Garden-Speed-Hub-X-Keyless-38062\"))()"},
    {name = "Lunor", code = "loadstring(game:HttpGet(\"https://lunor.dev/loader\"))()"},
    {name = "ThunderZ", code = "loadstring(game:HttpGet('https://raw.githubusercontent.com/ThundarZ/Welcome/refs/heads/main/Main/GaG/Main.lua'))()"}
}

-- Function to create script button
local function createScriptButton(script, index)
    local scriptContainer = Instance.new("Frame")
    scriptContainer.Name = "ScriptContainer_" .. index
    scriptContainer.Size = UDim2.new(1, -10, 0, 35)
    scriptContainer.Position = UDim2.new(0, 5, 0, (index - 1) * 40)
    scriptContainer.BackgroundColor3 = Color3.new(0.98, 0.98, 0.98)
    scriptContainer.BorderSizePixel = 0
    scriptContainer.Parent = scriptContent
    
    local containerCorner = Instance.new("UICorner")
    containerCorner.CornerRadius = UDim.new(0, 6)
    containerCorner.Parent = scriptContainer
    
    local scriptButton = Instance.new("TextButton")
    scriptButton.Name = "ScriptButton"
    scriptButton.Size = UDim2.new(1, -4, 1, -4)
    scriptButton.Position = UDim2.new(0, 2, 0, 2)
    scriptButton.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
    scriptButton.Text = "‚ñ∂Ô∏è " .. script.name
    scriptButton.TextColor3 = Color3.new(1, 1, 1)
    scriptButton.TextSize = 12
    scriptButton.Font = Enum.Font.GothamBold
    scriptButton.TextXAlignment = Enum.TextXAlignment.Left
    scriptButton.Parent = scriptContainer
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 4)
    buttonCorner.Parent = scriptButton
    
    -- Add padding for text
    local padding = Instance.new("UIPadding")
    padding.PaddingLeft = UDim.new(0, 8)
    padding.Parent = scriptButton
    
    -- Button click event
    scriptButton.MouseButton1Click:Connect(function()
        scriptButton.Text = "‚è≥ Loading..."
        scriptButton.BackgroundColor3 = Color3.new(1, 0.6, 0.2)
        
        task.spawn(function()
            pcall(function()
                loadstring(script.code)()
            end)
            
            task.wait(0.5)
            if scriptButton and scriptButton.Parent then
                scriptButton.Text = "‚úÖ " .. script.name
                scriptButton.BackgroundColor3 = Color3.new(0.2, 0.8, 0.2)
                
                task.wait(2)
                if scriptButton and scriptButton.Parent then
                    scriptButton.Text = "‚ñ∂Ô∏è " .. script.name
                    scriptButton.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
                end
            end
        end)
    end)
    
    -- Hover effects
    scriptButton.MouseEnter:Connect(function()
        if scriptButton.Text:find("‚ñ∂Ô∏è") then
            scriptButton.BackgroundColor3 = Color3.new(1, 0.5, 0.8)
        end
    end)
    
    scriptButton.MouseLeave:Connect(function()
        if scriptButton.Text:find("‚ñ∂Ô∏è") then
            scriptButton.BackgroundColor3 = Color3.new(1, 0.4, 0.7)
        end
    end)
    
    return scriptContainer
end

-- Function to filter and display scripts
local function filterScripts(searchTerm)
    -- Clear existing script buttons
    for _, child in pairs(scriptContent:GetChildren()) do
        if child.Name:find("ScriptContainer_") then
            child:Destroy()
        end
    end
    
    local filteredScripts = {}
    searchTerm = searchTerm:lower()
    
    for _, script in pairs(scriptsData) do
        if searchTerm == "" or script.name:lower():find(searchTerm) then
            table.insert(filteredScripts, script)
        end
    end
    
    -- Create buttons for filtered scripts
    for i, script in pairs(filteredScripts) do
        createScriptButton(script, i)
    end
    
    -- Update canvas size
    scriptContent.CanvasSize = UDim2.new(0, 0, 0, #filteredScripts * 40 + 10)
end

-- Search functionality
searchBox:GetPropertyChangedSignal("Text"):Connect(function()
    filterScripts(searchBox.Text)
end)

clearButton.MouseButton1Click:Connect(function()
    searchBox.Text = ""
    filterScripts("")
end)

-- Initialize scripts display
filterScripts("")

-- Tab Switching
local function switchTab(tabName)
    if tabName == "Home" then
        homeContent.Visible = true
        scriptContent.Visible = false
        searchFrame.Visible = false
        homeTab.BackgroundColor3 = Color3.new(1, 1, 1)
        homeTab.TextColor3 = Color3.new(0.2, 0.2, 0.2)
        scriptTab.BackgroundColor3 = Color3.new(0.8, 0.8, 0.8)
        scriptTab.TextColor3 = Color3.new(0.4, 0.4, 0.4)
    else
        homeContent.Visible = false
        scriptContent.Visible = true
        searchFrame.Visible = true
        homeTab.BackgroundColor3 = Color3.new(0.8, 0.8, 0.8)
        homeTab.TextColor3 = Color3.new(0.4, 0.4, 0.4)
        scriptTab.BackgroundColor3 = Color3.new(1, 1, 1)
        scriptTab.TextColor3 = Color3.new(0.2, 0.2, 0.2)
    end
end

homeTab.MouseButton1Click:Connect(function()
    switchTab("Home")
end)

scriptTab.MouseButton1Click:Connect(function()
    switchTab("Script")
end)

-- Close/Toggle functionality
closeButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
    toggleButton.Visible = true
end)

toggleButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = true
    toggleButton.Visible = false
end)

-- Keyboard shortcut (Right Shift)
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.RightShift then
        if mainFrame.Visible then
            mainFrame.Visible = false
            toggleButton.Visible = true
        else
            mainFrame.Visible = true
            toggleButton.Visible = false
        end
    end
end)

-- Character respawn handling with proper cleanup
local function cleanupConnections()
    if noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = nil
    end
    if flyConnection then
        flyConnection:Disconnect()
        flyConnection = nil
    end
    if bodyVelocity then
        bodyVelocity:Destroy()
        bodyVelocity = nil
    end
    if bodyAngularVelocity then
        bodyAngularVelocity:Destroy()
        bodyAngularVelocity = nil
    end
end

player.CharacterAdded:Connect(function(newCharacter)
    -- Clean up old connections
    cleanupConnections()
    
    -- Reset variables
    character = newCharacter
    humanoid = character:WaitForChild("Humanoid")
    noclip = false
    flying = false
    
    -- Wait for character to fully load
    task.wait(1)
    
    -- Reset to original values
    if humanoid then
        humanoid.WalkSpeed = originalWalkSpeed
        humanoid.JumpPower = originalJumpPower
    end
end)

-- Cleanup on script end
game:GetService("RunService").Heartbeat:Connect(function()
    if not character or not character.Parent then
        -- Character was removed, clean up
        if character ~= (player.Character or player.CharacterAdded:Wait()) then
            cleanupConnections()
        end
    end
end)

-- Show UI after loading
task.wait(2.5)
if mainFrame then
    mainFrame.Visible = true
end

print("Mila UI ƒë√£ ƒë∆∞·ª£c t·∫£i th√†nh c√¥ng! üíñ")
print("Nh·∫•n Right Shift ƒë·ªÉ b·∫≠t/t·∫Øt UI")
print("Ph√≠m ƒëi·ªÅu khi·ªÉn Fly:")